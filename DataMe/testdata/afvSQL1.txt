afv=# CREATE TABLE H2stations(gid BIGSERIAL NOT NULL, name VARCHAR(50),zip int, lat double precision, lon double precision);
afv=#  alter table H2stations alter column name type character varying(120);    ALTER TABLE
afv=# copy H2stations(name, zip, lat, lon) from '/Users/user/Documents/GIS/Capstone/2020data/H_stationsRD.csv' DELIMITERS ',' CSV HEADER;
COPY 46

afv=# alter table H2stations alter column zip type VARCHAR(10);
afv=# DELETE from H2stations;
afv=# ALTER SEQUENCE H2stations_gid_seq RESTART;
afv-# CREATE EXTENSION postgis;
afv=# ALTER TABLE H2stations ADD COLUMN geom geometry(Point, 4326);
afv=# UPDATE H2stations SET geom = ST_SetSRID(ST_MakePoint(lat, lon), 4326);
afv=# COPY H2stations TO '/Users/user/Documents/GIS/Capstone/DataMe/H2_stationsGeo.csv' DELIMITER ',' CSV HEADER;

#The scripts created a table of H2 stations in the AFV database, altered some datatypes of the fields, altered the SEQUENCE of the gid field, copied the csv fileds to the table, created geometry using the lat lon fields, and export the table as csv with an added geom filed.

# the original csv file downloaded from the afdc.energy.org website had many excessive fields, I cleaned the data by reducing to four fields that are needed for the project: name, zip, lat, lon. The gid is automatically generated by PostgreSQL BIGINT sequence.

#restarting the database server helps me to solve the problem of not being able to create a table.I tried many fancy commands from Stackoverflow, but this simple solution was unexpected. 

# In PostgreSQL, the main commands are UPPER case sensitive, such as CREATE TABLE, but the file names are not case sensitive, I could use H2stations or h2stations alternatively. 

# more details can be found in the database dump I create. Future collaborators can use it as a database backup or find the SQL scripts they will need.

Create TABLE h2combines(gid serial NOT NULL, stations1 VARCHAR(100), stations2 VARCHAR(100), zip1 VARCHAR(50), lat1 double precision, lon1 double precision, geom1 geometry, zip2 VARCHAR(50), lat2 double precision, lon2 double precision, geom2 geometry);

 \COPY h2combines(stations1, stations2,zip1,lat1,lon1,geom1,zip2,lat2,lon2,geom2) FROM '/Users/user/Documents/GIS/Capstone/DataMe/leftjoin2.csv' DELIMITERS ',' CSV HEADER;

--- converting lon lat coords to geography
ALTER TABLE sometable ADD COLUMN geog geography(POINT,4326);
UPDATE sometable SET geog = ST_GeogFromText('SRID=4326;POINT(' || lon || ' ' || lat || ')');

--- specify a geography point using EPSG:4267, NAD27
SELECT ST_AsEWKT(ST_GeogFromText('SRID=4267;POINT(-77.0092 38.889588)'));


			


